////////////////////////////////////////////////...System of Equations Inputs ...//////////////////////////////////////////

	double hf[16];
	hf[1]=Hin;
	hf[2]=Hs6;
	hf[3]=Hs8;
	hf[4]=Hs10;
	hf[5]=Hs14;
	hf[6]=Hs16;
	hf[7]=Hs18;
	hf[8]=Hs20;
	hf[9]=HsatL(Ps20);
	double hde=681;
	hf[16]=HsatL(0.92*Ps6);
	hf[17]=HsatL(0.92*Ps8);
	hf[18]=HsatL(0.92*Ps14);
	hf[19]=HsatL(0.92*Ps16);
	hf[20]=HsatL(0.92*Ps18);
	
	double dh1h=0, dh2h=0, dh1l=0, dh2l=0, dh3l=0;
	dh3l=0.2174*Qin+44.698;
	dh2l=167.57*Qin-6133.2;
	if (dh2l<0)
	dh2l=0;
	dh1l=117.09*Qin-3084;
	if (dh1l<0)
	dh1l=0;
	dh2h=1.0088*Qin-66.015;
	if (dh2h<0)
	dh2h=0;
	dh1h=0.1909*Qin+59.613;

	double b[N][N+1];
	
	//Energy Conservation of Turbine
	b[0][0]=3.6;
	b[0][1]=1;
	b[0][2]=1;
	b[0][3]=1;
	b[0][4]=1;
	b[0][5]=1;
	b[0][6]=1;
	b[0][7]=1;
	b[0][8]=0;
	b[0][9]=0;
	b[0][10]=0;
	b[0][11]=0;
	b[0][12]=0;
	b[0][13]=0;
	b[0][14]=0;
	b[0][15]=0;
	b[0][16]=0;
	b[0][17]=0;
	b[0][18]=0;
	b[0][19]=0;
	b[0][20]=m1*Hin-1.03*(ma+mb+mc+md+me+mf+mm)*Hin;
	
	//Energy Conservation of Condensser
	b[1][0]=0;
	b[1][1]=0;
	b[1][2]=0;
	b[1][3]=0;
	b[1][4]=0;
	b[1][5]=0;
	b[1][6]=0;
	b[1][7]=-1/hf[8]*hf[9];
	b[1][8]=1;
	b[1][9]=0;
	b[1][10]=0;
	b[1][11]=0;
	b[1][12]=0;
	b[1][13]=0;
	b[1][14]=0;	
	b[1][15]=0;
	b[1][16]=0;
	b[1][17]=0;
	b[1][18]=0;
	b[1][19]=0;
	b[1][20]=0;
		
	//Energy Conservation of Condensate Pump
	b[2][0]=0;
	b[2][1]=0;
	b[2][2]=0;
	b[2][3]=0;
	b[2][4]=0;
	b[2][5]=0;
	b[2][6]=0;
	b[2][7]=0;
	b[2][8]=1;
	b[2][9]=-1;
	b[2][10]=0;
	b[2][11]=0;
	b[2][12]=0;
	b[2][13]=0;
	b[2][14]=0;
	b[2][15]=0;
	b[2][16]=0;
	b[2][17]=0;
	b[2][18]=0;
	b[2][19]=0;
	b[2][20]=-3.6*Ethacp*Powercp;
		
	//Energy Conservation of 3rd Lp Heater
	b[3][0]=0;
	b[3][1]=0;
	b[3][2]=0;
	b[3][3]=0;
	b[3][4]=0;
	b[3][5]=0;
	b[3][6]=1;
	b[3][7]=0;
	b[3][8]=0;
	b[3][9]=1;
	b[3][10]=-1;
	b[3][11]=0;
	b[3][12]=0;
	b[3][13]=0;
	b[3][14]=0;
	b[3][15]=0;
	b[3][16]=0;
	b[3][17]=0;
	b[3][18]=1;
	b[3][19]=-1;
	b[3][20]=-me*he-0.31*3226-0.44*3475;
	
	//Energy Conservation of 2nd Lp Heater
	b[4][0]=0;
	b[4][1]=0;
	b[4][2]=0;
	b[4][3]=0;
	b[4][4]=0;
	b[4][5]=1;
	b[4][6]=0;
	b[4][7]=0;
	b[4][8]=0;
	b[4][9]=0;
	b[4][10]=1;
	b[4][11]=-1;
	b[4][12]=0;
	b[4][13]=0;
	b[4][14]=0;
	b[4][15]=0;
	b[4][16]=0;
	b[4][17]=1;
	b[4][18]=-1;
	b[4][19]=1;
	b[4][20]=0;
	
	//Energy Conservation of 1st Lp Heater
	b[5][0]=0;
	b[5][1]=0;
	b[5][2]=0;
	b[5][3]=0;
	b[5][4]=1;
	b[5][5]=0;
	b[5][6]=0;
	b[5][7]=0;
	b[5][8]=0;
	b[5][9]=0;
	b[5][10]=0;
	b[5][11]=1;
	b[5][12]=-1;
	b[5][13]=0;
	b[5][14]=0;
	b[5][15]=0;
	b[5][16]=0;
	b[5][17]=-1;
	b[5][18]=0;
	b[5][19]=0;
	b[5][20]=-md*hd;
	
	//Energy Conservation of Deaerator
	b[6][0]=0;
	b[6][1]=0;
	b[6][2]=0;
	b[6][3]=1;
	b[6][4]=0;
	b[6][5]=0;
	b[6][6]=0;
	b[6][7]=0;
	b[6][8]=0;
	b[6][9]=0;
	b[6][10]=0;
	b[6][11]=0;
	b[6][12]=1;
	b[6][13]=0;
	b[6][14]=0;
	b[6][15]=0;
	b[6][16]=1;
	b[6][17]=0;
	b[6][18]=0;
	b[6][19]=0;
	b[6][20]=Qin*hde-3.6*Ethafp*Powerfp-ha*ma;
	
	//Energy Conservation of 2nd HP Heater
	b[7][0]=0;
	b[7][1]=0;
	b[7][2]=-1;
	b[7][3]=0;
	b[7][4]=0;
	b[7][5]=0;
	b[7][6]=0;
	b[7][7]=0;
	b[7][8]=0;
	b[7][9]=0;
	b[7][10]=0;
	b[7][11]=0;
	b[7][12]=0;
	b[7][13]=1;
	b[7][14]=0;
	b[7][15]=-1;
	b[7][16]=1;
	b[7][17]=0;
	b[7][18]=0;
	b[7][19]=0;
	b[7][20]=Qin*hde+mc*hc;
	
	//Energy Conservation of 1st Hp Heater
	b[8][0]=0;
	b[8][1]=1;
	b[8][2]=0;
	b[8][3]=0;
	b[8][4]=0;
	b[8][5]=0;
	b[8][6]=0;
	b[8][7]=0;
	b[8][8]=0;
	b[8][9]=0;
	b[8][10]=0;
	b[8][11]=0;
	b[8][12]=0;
	b[8][13]=1;
	b[8][14]=-1;
	b[8][15]=-1;
	b[8][16]=0;
	b[8][17]=0;
	b[8][18]=0;
	b[8][19]=0;
	b[8][20]=0;
		
	//Mass Conservation of Turbine
	b[9][0]=0;
	b[9][1]=1/Hs6;
	b[9][2]=1/Hs8;
	b[9][3]=1/Hs10;
	b[9][4]=1/Hs14;
	b[9][5]=1/Hs16;
	b[9][6]=1/Hs18;
	b[9][7]=1/Hs20;
	b[9][8]=0;
	b[9][9]=0;
	b[9][10]=0;
	b[9][11]=0;
	b[9][12]=0;
	b[9][13]=0;
	b[9][14]=0;
	b[9][15]=0;
	b[9][16]=0;
	b[9][17]=0;
	b[9][18]=0;
	b[9][19]=0;
	b[9][20]=Qin-ma-mb-mc-md-me-mf;
	
	//Enthalpy Increase in 3rd Lp Heater
	b[10][0]=0;
	b[10][1]=0;
	b[10][2]=0;
	b[10][3]=0;
	b[10][4]=0;
	b[10][5]=0;
	b[10][6]=0;
	b[10][7]=-dh3l/hf[8];
	b[10][8]=0;
	b[10][9]=-1;
	b[10][10]=1;
	b[10][11]=0;
	b[10][12]=0;
	b[10][13]=0;
	b[10][14]=0;
	b[10][15]=0;
	b[10][16]=0;
	b[10][17]=0;
	b[10][18]=0;
	b[10][19]=0;
	b[10][20]=(0.75+0.28)*dh3l;
	
	//Enthalpy Increase in 2nd Lp Heater
	b[11][0]=0;
	b[11][1]=0;
	b[11][2]=0;
	b[11][3]=0;
	b[11][4]=0;
	b[11][5]=0;
	b[11][6]=0;
	b[11][7]=0;
	b[11][8]=0;
	b[11][9]=0;
	b[11][10]=-1;
	b[11][11]=1;
	b[11][12]=0;
	b[11][13]=0;
	b[11][14]=0;
	b[11][15]=0;
	b[11][16]=0;
	b[11][17]=0;
	b[11][18]=0;
	b[11][19]=0;
	b[11][20]=dh2l;
	
	//Enthalpy Increase in 1st Lp Heater
	b[12][0]=0;
	b[12][1]=0;
	b[12][2]=0;
	b[12][3]=0;
	b[12][4]=0;
	b[12][5]=0;
	b[12][6]=0;
	b[12][7]=0;
	b[12][8]=0;
	b[12][9]=0;
	b[12][10]=0;
	b[12][11]=-1;
	b[12][12]=1;
	b[12][13]=0;
	b[12][14]=0;
	b[12][15]=0;
	b[12][16]=0;
	b[12][17]=0;
	b[12][18]=0;
	b[12][19]=0;
	b[12][20]=dh1l;

	//Enthalpy Increase in 2nd HP Heater
	b[13][0]=0;
	b[13][1]=0;
	b[13][2]=0;
	b[13][3]=0;
	b[13][4]=0;
	b[13][5]=0;
	b[13][6]=0;
	b[13][7]=0;
	b[13][8]=0;
	b[13][9]=0;
	b[13][10]=0;
	b[13][11]=0;
	b[13][12]=0;
	b[13][13]=1;
	b[13][14]=0;
	b[13][15]=0;
	b[13][16]=0;
	b[13][17]=0;
	b[13][18]=0;
	b[13][19]=0;
	b[13][20]=dh2h*Qin+681*Qin;

	//Enthalpy Increase in 1st HP Heater
	b[14][0]=0;
	b[14][1]=0;
	b[14][2]=0;
	b[14][3]=0;
	b[14][4]=0;
	b[14][5]=0;
	b[14][6]=0;
	b[14][7]=0;
	b[14][8]=0;
	b[14][9]=0;
	b[14][10]=0;
	b[14][11]=0;
	b[14][12]=0;
	b[14][13]=-1;
	b[14][14]=1;
	b[14][15]=0;
	b[14][16]=0;
	b[14][17]=0;
	b[14][18]=0;
	b[14][19]=0;
	b[14][20]=dh1h*Qin;
	
	//Mass Conservation in 1st HP Heater
	b[15][0]=0;
	b[15][1]=hf[16]/hf[2];
	b[15][2]=0;
	b[15][3]=0;
	b[15][4]=0;
	b[15][5]=0;
	b[15][6]=0;
	b[15][7]=0;
	b[15][8]=0;
	b[15][9]=0;
	b[15][10]=0;
	b[15][11]=0;
	b[15][12]=0;
	b[15][13]=0;
	b[15][14]=0;
	b[15][15]=-1;
	b[15][16]=0;
	b[15][17]=0;
	b[15][18]=0;
	b[15][19]=0;
	b[15][20]=0;
	
	//Mass Conservation in 2nd HP Heater
	b[16][0]=0;
	b[16][1]=0;
	b[16][2]=hf[17]/hf[3];
	b[16][3]=0;
	b[16][4]=0;
	b[16][5]=0;
	b[16][6]=0;
	b[16][7]=0;
	b[16][8]=0;
	b[16][9]=0;
	b[16][10]=0;
	b[16][11]=0;
	b[16][12]=0;
	b[16][13]=0;
	b[16][14]=0;
	b[16][15]=hf[17]/hf[16];
	b[16][16]=-1;
	b[16][17]=0;
	b[16][18]=0;
	b[16][19]=0;
	b[16][20]=0;
	
	//Mass Conservation in 1st LP Heater
	b[17][0]=0;
	b[17][1]=0;
	b[17][2]=0;
	b[17][3]=0;
	b[17][4]=hf[18]/hf[5];
	b[17][5]=0;
	b[17][6]=0;
	b[17][7]=0;
	b[17][8]=0;
	b[17][9]=0;
	b[17][10]=0;
	b[17][11]=0;
	b[17][12]=0;
	b[17][13]=0;
	b[17][14]=0;
	b[17][15]=0;
	b[17][16]=0;
	b[17][17]=-1;
	b[17][18]=0;
	b[17][19]=0;
	b[17][20]=0;
	
	//Mass Conservation in 2nd LP Heater
	b[18][0]=0;
	b[18][1]=0;
	b[18][2]=0;
	b[18][3]=0;
	b[18][4]=0;
	b[18][5]=hf[19]/hf[6];
	b[18][6]=0;
	b[18][7]=0;
	b[18][8]=0;
	b[18][9]=0;
	b[18][10]=0;
	b[18][11]=0;
	b[18][12]=0;
	b[18][13]=0;
	b[18][14]=0;
	b[18][15]=0;
	b[18][16]=0;
	b[18][17]=hf[19]/hf[18];
	b[18][18]=-1;
	b[18][19]=0;
	b[18][20]=0;
	
	//Mass Conservation in 3rd LP Heater
	b[19][0]=0;
	b[19][1]=0;
	b[19][2]=0;
	b[19][3]=0;
	b[19][4]=0;
	b[19][5]=0;
	b[19][6]=hf[20]/hf[7];
	b[19][7]=0;
	b[19][8]=0;
	b[19][9]=0;
	b[19][10]=0;
	b[19][11]=0;
	b[19][12]=0;
	b[19][13]=0;
	b[19][14]=0;
	b[19][15]=0;
	b[19][16]=0;
	b[19][17]=0;
	b[19][18]=hf[20]/hf[19];
	b[19][19]=-1;
	b[19][20]=0;

	    double a[N][N+1] = {
        {b[0][0], b[0][1], b[0][2], b[0][3], b[0][4], b[0][5], b[0][6], b[0][7], b[0][8], b[0][9], b[0][10], b[0][11], b[0][12], b[0][13], b[0][14], b[0][15], b[0][16], b[0][17], b[0][18], b[0][19], b[0][20]},
        {b[1][0], b[1][1], b[1][2], b[1][3], b[1][4], b[1][5], b[1][6], b[1][7], b[1][8], b[1][9], b[1][10], b[1][11], b[1][12], b[1][13], b[1][14], b[1][15], b[1][16], b[1][17], b[1][18], b[1][19], b[1][20]},
        {b[2][0], b[2][1], b[2][2], b[2][3], b[2][4], b[2][5], b[2][6], b[2][7], b[2][8], b[2][9], b[2][10], b[2][11], b[2][12], b[2][13], b[2][14], b[2][15], b[2][16], b[2][17], b[2][18], b[2][19], b[2][20]},
        {b[3][0], b[3][1], b[3][2], b[3][3], b[3][4], b[3][5], b[3][6], b[3][7], b[3][8], b[3][9], b[3][10], b[3][11], b[3][12], b[3][13], b[3][14], b[3][15], b[3][16], b[3][17], b[3][18], b[3][19], b[3][20]},
        {b[4][0], b[4][1], b[4][2], b[4][3], b[4][4], b[4][5], b[4][6], b[4][7], b[4][8], b[4][9], b[4][10], b[4][11], b[4][12], b[4][13], b[4][14], b[4][15], b[4][16], b[4][17], b[4][18], b[4][19], b[4][20]},
        {b[5][0], b[5][1], b[5][2], b[5][3], b[5][4], b[5][5], b[5][6], b[5][7], b[5][8], b[5][9], b[5][10], b[5][11], b[5][12], b[5][13], b[5][14], b[5][15], b[5][16], b[5][17], b[5][18], b[5][19], b[5][20]},
        {b[6][0], b[6][1], b[6][2], b[6][3], b[6][4], b[6][5], b[6][6], b[6][7], b[6][8], b[6][9], b[6][10], b[6][11], b[6][12], b[6][13], b[6][14], b[6][15], b[6][16], b[6][17], b[6][18], b[6][19], b[6][20]},
        {b[7][0], b[7][1], b[7][2], b[7][3], b[7][4], b[7][5], b[7][6], b[7][7], b[7][8], b[7][9], b[7][10], b[7][11], b[7][12], b[7][13], b[7][14], b[7][15], b[7][16], b[7][17], b[7][18], b[7][19], b[7][20]},
        {b[8][0], b[8][1], b[8][2], b[8][3], b[8][4], b[8][5], b[8][6], b[8][7], b[8][8], b[8][9], b[8][10], b[8][11], b[8][12], b[8][13], b[8][14], b[8][15], b[8][16], b[8][17], b[8][18], b[8][19], b[8][20]},
        {b[9][0], b[9][1], b[9][2], b[9][3], b[9][4], b[9][5], b[9][6], b[9][7], b[9][8], b[9][9], b[9][10], b[9][11], b[9][12], b[9][13], b[9][14], b[9][15], b[9][16], b[9][17], b[9][18], b[9][19], b[9][20]},
        {b[10][0], b[10][1], b[10][2], b[10][3], b[10][4], b[10][5], b[10][6], b[10][7], b[10][8], b[10][9], b[10][10], b[10][11], b[10][12], b[10][13], b[10][14], b[10][15], b[10][16], b[10][17], b[10][18], b[10][19], b[10][20]},
        {b[11][0], b[11][1], b[11][2], b[11][3], b[11][4], b[11][5], b[11][6], b[11][7], b[11][8], b[11][9], b[11][10], b[11][11], b[11][12], b[11][13], b[11][14], b[11][15], b[11][16], b[11][17], b[11][18], b[11][19], b[11][20]},
        {b[12][0], b[12][1], b[12][2], b[12][3], b[12][4], b[12][5], b[12][6], b[12][7], b[12][8], b[12][9], b[12][10], b[12][11], b[12][12], b[12][13], b[12][14], b[12][15], b[12][16], b[12][17], b[12][18], b[12][19], b[12][20]},
        {b[13][0], b[13][1], b[13][2], b[13][3], b[13][4], b[13][5], b[13][6], b[13][7], b[13][8], b[13][9], b[13][10], b[13][11], b[13][12], b[13][13], b[13][14], b[13][15], b[13][16], b[13][17], b[13][18], b[13][19], b[13][20]},
        {b[14][0], b[14][1], b[14][2], b[14][3], b[14][4], b[14][5], b[14][6], b[14][7], b[14][8], b[14][9], b[14][10], b[14][11], b[14][12], b[14][13], b[14][14], b[14][15], b[14][16], b[14][17], b[14][18], b[14][19], b[14][20]},
        {b[15][0], b[15][1], b[15][2], b[15][3], b[15][4], b[15][5], b[15][6], b[15][7], b[15][8], b[15][9], b[15][10], b[15][11], b[15][12], b[15][13], b[15][14], b[15][15], b[15][16], b[15][17], b[15][18], b[15][19], b[15][20]},
        {b[16][0], b[16][1], b[16][2], b[16][3], b[16][4], b[16][5], b[16][6], b[16][7], b[16][8], b[16][9], b[16][10], b[16][11], b[16][12], b[16][13], b[16][14], b[16][15], b[16][16], b[16][17], b[16][18], b[16][19], b[16][20]},
        {b[17][0], b[17][1], b[17][2], b[17][3], b[17][4], b[17][5], b[17][6], b[17][7], b[17][8], b[17][9], b[17][10], b[17][11], b[17][12], b[17][13], b[17][14], b[17][15], b[17][16], b[17][17], b[17][18], b[17][19], b[17][20]},
        {b[18][0], b[18][1], b[18][2], b[18][3], b[18][4], b[18][5], b[18][6], b[18][7], b[18][8], b[18][9], b[18][10], b[18][11], b[18][12], b[18][13], b[18][14], b[18][15], b[18][16], b[18][17], b[18][18], b[18][19], b[18][20]},
        {b[19][0], b[19][1], b[19][2], b[19][3], b[19][4], b[19][5], b[19][6], b[19][7], b[19][8], b[19][9], b[19][10], b[19][11], b[19][12], b[19][13], b[19][14], b[19][15], b[19][16], b[19][17], b[19][18], b[19][19], b[19][20]},
      
        
    
	};

    gauss_jordan(a, N);
    
	double MakeupPercent=0;
	cout<<"\nPlease Enter Percentage of Make-up Water (0-100):";
	cin>>MakeupPercent;
	double PowerGen=EthaGen*a[0][N];
	double Flow1stHpEx=a[1][N]/hf[2];
	double Flow2ndHpEx=a[2][N]/hf[3];
	double FlowDeaEx=a[3][N]/hf[4];
	double Flow1stLpEx=a[4][N]/hf[5];
	double Flow2ndLpEx=a[5][N]/hf[6];
	double Flow3rdLpEx=a[6][N]/hf[7];
	double FlowCond=a[7][N]/hf[8];
	double FlowCondOut=(1.0+MakeupPercent/100)*FlowCond+mm+0.31+0.28;
	double EnthalpyCondOut=a[8][N]/FlowCondOut; 
	//double EnthalpyCondOut=hf[9];    
	//double FlowCondOut=a[8][N]/hf[9];
	double EnthalpyCP=a[9][N]/FlowCondOut;
	double Enthalpy3rdLP=a[10][N]/FlowCondOut;
	double FlowInt=FlowCondOut+Flow1stLpEx+Flow2ndLpEx+Flow3rdLpEx+me+md;
	double Enthalpy2ndLP=a[11][N]/FlowInt;
	double Enthalpy1stLP=a[12][N]/FlowInt;
	double Enthalpy2ndHP=a[13][N]/Qin;
	double Enthalpy1stHP=a[14][N]/Qin;
	
/*
    
	cout << "\n----------\nPower Generated = " << PowerGen <<"  kW"<< endl;
	
	cout << "\nFlow of 1st Hp FWH Ext = " << Flow1stHpEx <<"  t/h"<< endl;
	
	cout << "Flow of 2nd HP FWH Ext = " << Flow2ndHpEx <<"  t/h"<< endl;
	
	cout << "Flow of Deaerator Ext = " << FlowDeaEx <<"  t/h"<< endl;
	
	cout << "Flow of 1st LP FWH Ext = " << Flow1stLpEx <<"  t/h"<< endl;
	
	cout << "Flow of 2nd LP FWH Ext = " << Flow2ndLpEx <<"  t/h"<< endl;
	
	cout << "Flow of 3rd LP FWH Ext = " << Flow3rdLpEx <<"  t/h"<< endl;
	
	cout << "\nCondensser Flow = " << FlowCond <<"  t/h"<< endl;
	
	cout << "Condensser Flow + Extractions + Gland Steam = " << Flow1stHpEx+Flow2ndHpEx+FlowDeaEx+Flow1stLpEx+Flow2ndLpEx+Flow3rdLpEx+FlowCond+ma+mb+mc+md+me+mf+mm <<"  t/h"<< endl;
	
	cout << "Condensser Outlet Enthalpy = " << EnthalpyCondOut <<"  kj/kg"<< endl;

	cout << "Condensser Outlet Flow = " << FlowCondOut <<"  t/h"<< endl;

	cout << "Enthalpy at Condensate Pump Outlet = " << EnthalpyCP <<"  Kj/Kg"<< endl;
	
	cout << "\nEnthalpy at 3rd LP F.W.H Outlet = " << Enthalpy3rdLP <<"  Kj/Kg"<< endl;

	cout << "Enthalpy at 2nd LP F.W.H Outlet = " << Enthalpy2ndLP <<"  Kj/Kg"<< endl;
	
	cout << "Enthalpy at 1st LP F.W.H Outlet = " << Enthalpy1stLP <<"  Kj/Kg"<< endl;
	
	cout << "\nEnthalpy at Deaerator's Outlet = " << hde <<"  Kj/Kg"<< endl;
	
	cout << "\nEnthalpy at 2nd HP F.W.H Outlet = " << Enthalpy2ndHP <<"  Kj/Kg"<< endl;
	
	cout << "Enthalpy at 1st HP F.W.H Outlet = " << Enthalpy1stHP <<"  Kj/Kg"<< endl;
	
	cout << "\nCondenser Heat Load = " << FlowCond*(hf[8]-hf[9])/3.6/1000<<"  MW"<< endl;
	
	*/